{% extends 'header.html' %}

{% block body %}

<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>

<div class="position-relative">
    <div class="col-lg-12">
        <div class="panel panel-success">
            <div class="panel-heading">
                <p class="text-muted font-13 m-b-30" style="text-align: center;"> <button type="button"
                        data-bs-toggle="modal" data-bs-target="#NewField" class="btn btn-primary">Nuevo Cliente</button>
                </p>
            </div>
        </div>
    </div>

    <div class="col-lg-12">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        {% for mensaje in messages %}
        <div class="alert alert-warning alert-dismissible fade show" role="alert" id="success-alert"> <strong>{{
                mensaje }}</strong> <button type="button" class="btn-close" data-bs-dismiss="alert"
                aria-label="Close"></button>
        </div>
        {% endfor %}
        {% endif %}
        {% endwith %}
    </div>
</div>
<h2>Lista de Clientes</h2>
<div class="panel-body">
    {% block content%}
    <table class="table table-striped">
        <tr>
            <th>Idcliente</th>
            <th>Nombre</th>
            <th>Apellido1</th>
            <th>Apellido2</th>
            <th>Telefono</th>
            <th>Acci√≥n</th>
        </tr>
        {% for carro in tbclientes %}
        <tr>
            <td>{{ carro.Idcliente }}</td>
            <td>{{ carro.Nombre }}</td>
            <td>{{ carro.Apellido1 }}</td>
            <td>{{ carro.Apellido2 }}</td>
            <td>{{ carro.Telefono }}</td>
            <td>
                <button type="button" data-id="{{ carro.Idcliente }}" class="carroInfo btn btn-success"
                    title="Detalles">Detalles</button>
                <a href="/deletecarros/{{ carro.Idcliente }}" class="btn btn-outline btn-danger" onclick="return confirm('Esta seguro de eliminar este registro ?')">Eliminar</a>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% endblock%}
</div>

<div class="modal fade" id="NewField" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Registro de un nuevo Cliente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="insert_form" method="POST" action="/addcarros">
                <div class="modal-body">
                    <table class="table table-hover">
                        <tr>
                            <th>Idcliente</th>
                            <th><input type="text" name="Idcliente" id="Idcliente" class="form-control" required="true">
                            </th>
                        </tr>
                        <tr>
                            <th>Nombre</th>
                            <th><input type="text" name="Nombre" id="Nombre" class="form-control" required="true">
                            </th>
                        </tr>
                        <tr>
                            <th>Apellido1</th>
                            <th><input type="text" name="Apellido1" id="Apellido1" class="form-control" required="true">
                            </th>
                        </tr>
                        <tr>
                            <th>Apellido2</th>
                            <th><input type="text" name="Apellido2" id="Apellido2" class="form-control" required="true">
                            </th>
                        </tr>
                        <tr>
                            <th>Telefono</th>
                            <th><input type="text" name="Telefono" id="Telefono" class="form-control"
                                    required="true"></th>
                        </tr>

                        <tr>
                            <th colspan="2"><button type="submit" class="btn btn-primary">Registrar Cliente</button>
                            </th>
                        </tr>
                    </table>
                </div>
            </form>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="viewField" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Vista de un Cliente</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-cuerpo">

            </div>

            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>



<script type="text/javascript">
    $(document).ready(function () {
        $("#success-alert").fadeTo(3000, 500).slideUp(500, function () {
            $("#success-alert").slideUp(500);
        });
        $('.carroInfo').click(function () {
            var id = $(this).data('id');
            $.ajax({
                url: '/viewcarros',
                type: 'POST',
                data: { id: id },
                success: function (data) {
                    $('.modal-cuerpo').html(data);
                    $('.modal-cuerpo').append(data.htmlresponse);
                    $('#viewField').modal('show');
                }
            });
        });
    }); 
</script>



{% endblock %}